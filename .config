# =============================================
# OpenWrt 编译配置文件 - Netgear WNDR3800 专用
# 详细注释版本 - 每个配置项都有详细说明
# =============================================

#
# 目标系统配置
#
CONFIG_TARGET_ath79=y                      # 使用 Atheros AR71xx/AR913x/AR934x 架构
CONFIG_TARGET_ath79_generic=y              # 通用 ath79 目标
CONFIG_TARGET_ath79_generic_DEVICE_netgear_wndr3800=y  # 具体设备型号：Netgear WNDR3800

#
# 镜像文件系统配置
#
CONFIG_TARGET_ROOTFS_SQUASHFS=y            # 使用 SquashFS 只读文件系统（节省空间，适合路由设备）
CONFIG_TARGET_ROOTFS_PARTSIZE=128          # WNDR3800 只有 128MB 闪存，设置根分区大小

#
# 内核版本配置
#
CONFIG_LINUX_5_15=y                        # 使用 Linux 5.15 内核（稳定版本）
CONFIG_KERNEL_BUILD_USER="OpenWrt"         # 内核构建用户标识
CONFIG_KERNEL_BUILD_DOMAIN="openwrt.org"   # 内核构建域名标识

# =============================================
# 基础系统包（必需组件，不要修改）
# =============================================

#
# 核心系统组件
#
CONFIG_PACKAGE_base-files=y                # 基础文件系统结构和脚本
CONFIG_PACKAGE_busybox=y                   # 嵌入式 Linux 工具集合（核心命令）
CONFIG_PACKAGE_ca-bundle=y                 # CA 证书包（HTTPS 访问必需）
CONFIG_PACKAGE_dropbear=y                  # 轻量级 SSH 服务器
CONFIG_PACKAGE_firewall=y                  # iptables 防火墙前端
CONFIG_PACKAGE_fstools=y                   # 文件系统工具（挂载/格式化）
CONFIG_PACKAGE_libc=y                      # C 运行时库
CONFIG_PACKAGE_libgcc=y                    # GCC 运行时库
CONFIG_PACKAGE_logd=y                      # 系统日志守护进程
CONFIG_PACKAGE_mtd=y                       # 内存技术设备工具（Flash 操作）
CONFIG_PACKAGE_netifd=y                    # 网络接口管理守护进程
CONFIG_PACKAGE_opkg=y                      # 轻量级包管理器
CONFIG_PACKAGE_procd=y                     # OpenWrt 进程管理守护进程
CONFIG_PACKAGE_ubox=y                      # OpenWrt 基础工具箱
CONFIG_PACKAGE_ubus=y                      # OpenWrt 系统总线
CONFIG_PACKAGE_ubusd=y                     # ubus 守护进程
CONFIG_PACKAGE_uci=y                       # 统一配置接口
CONFIG_PACKAGE_usign=y                     # OpenWrt 签名工具

# =============================================
# 系统工具包（增强系统功能）
# =============================================

#
# 命令行工具
#
CONFIG_PACKAGE_bash=y                      # Bash shell（比默认 ash 更强大）
CONFIG_PACKAGE_htop=y                      # 交互式进程查看器（增强版 top）
CONFIG_PACKAGE_nano=y                      # 简单易用的文本编辑器
CONFIG_PACKAGE_curl=y                      # 命令行 URL 传输工具（下载文件）

#
# 系统管理工具
#
CONFIG_PACKAGE_cronie=y                    # 定时任务守护进程（cron）
CONFIG_PACKAGE_cronie-anacron=y            # 支持 anacron 功能（错过任务补执行）

# =============================================
# 网络基础服务
# =============================================

#
# DHCP 和 DNS 服务
#
CONFIG_PACKAGE_dnsmasq-full=y              # 完整版 dnsmasq（DHCP + DNS 缓存）
CONFIG_PACKAGE_dnsmasq_full_dhcp=y         # dnsmasq DHCP 功能支持

#
# 防火墙和网络工具
#
CONFIG_PACKAGE_iptables=y                  # iptables 防火墙核心
CONFIG_PACKAGE_iptables-mod-conntrack-extra=y  # 连接跟踪扩展模块
CONFIG_PACKAGE_ip-full=y                   # 完整版 iproute2 工具

# =============================================
# IPv6 支持
# =============================================

CONFIG_PACKAGE_ipv6helper=y                # IPv6 配置助手
CONFIG_PACKAGE_odhcp6c=y                   # DHCPv6 客户端
CONFIG_PACKAGE_odhcpd-ipv6only=y           # DHCPv6 服务器（仅 IPv6）

# =============================================
# 存储和文件系统支持
# =============================================

#
# 存储管理工具
#
CONFIG_PACKAGE_automount=y                 # 自动挂载服务（自动识别U盘等设备）
CONFIG_PACKAGE_block-mount=y               # 块设备挂载工具
CONFIG_PACKAGE_blkid=y                     # 块设备信息查看工具
CONFIG_PACKAGE_lsblk=y                     # 列出块设备信息
CONFIG_PACKAGE_e2fsprogs=y                 # EXT2/3/4 文件系统工具
CONFIG_PACKAGE_fdisk=y                     # 磁盘分区工具
CONFIG_PACKAGE_usbutils=y                  # USB 设备信息工具

#
# 内核模块 - 文件系统支持
#
CONFIG_PACKAGE_kmod-fs-ext4=y              # EXT4 文件系统支持（Linux 标准）
CONFIG_PACKAGE_kmod-fs-vfat=y              # FAT/FAT32 文件系统支持（U盘常用）
CONFIG_PACKAGE_kmod-fs-ntfs3=y             # NTFS 文件系统支持（Windows 硬盘）
CONFIG_PACKAGE_kmod-fs-exfat=y             # exFAT 文件系统支持（大文件U盘）
CONFIG_PACKAGE_kmod-nls-utf8=y             # UTF-8 编码支持（中文文件名）
CONFIG_PACKAGE_kmod-nls-cp437=y            # CP437 编码支持（FAT文件系统）
CONFIG_PACKAGE_kmod-nls-iso8859-1=y        # ISO-8859-1 编码支持（西欧语言）

#
# 内核模块 - USB 支持
#
CONFIG_PACKAGE_kmod-usb-core=y             # USB 核心支持
CONFIG_PACKAGE_kmod-usb2=y                 # USB 2.0 支持
CONFIG_PACKAGE_kmod-usb-storage=y          # USB 存储设备支持
CONFIG_PACKAGE_kmod-usb-storage-extras=y   # USB 存储扩展支持
CONFIG_PACKAGE_kmod-usb-ohci=y             # USB OHCI 控制器支持
CONFIG_PACKAGE_kmod-usb-uhci=y             # USB UHCI 控制器支持
CONFIG_PACKAGE_kmod-usb-ledtrig-usbport=y  # USB 端口 LED 触发支持
CONFIG_PACKAGE_kmod-scsi-core=y            # SCSI 核心支持（某些USB设备需要）

#
# 内核模块 - 其他设备支持
#
CONFIG_PACKAGE_kmod-usb-acm=y              # USB ACM 支持（调制解调器）
CONFIG_PACKAGE_kmod-usb-serial=y           # USB 串口设备支持
CONFIG_PACKAGE_kmod-usb-serial-ftdi=y      # FTDI USB 串口芯片支持

#
# 内核模块 - 无线网络
#
CONFIG_PACKAGE_kmod-ath=y                  # Atheros 无线驱动通用模块
CONFIG_PACKAGE_kmod-ath9k=y                # Atheros 802.11n 无线驱动
CONFIG_PACKAGE_kmod-ath9k-common=y         # Atheros 通用支持模块
CONFIG_PACKAGE_kmod-cfg80211=y             # 无线配置 API
CONFIG_PACKAGE_kmod-mac80211=y             # MAC 802.11 无线栈
CONFIG_PACKAGE_wpad-openssl=y              # WPA 认证守护进程（OpenSSL 版本）

#
# 内核模块 - 网络功能
#
CONFIG_PACKAGE_kmod-ipt-conntrack=y        # 连接跟踪支持
CONFIG_PACKAGE_kmod-ipt-core=y             # iptables 核心模块
CONFIG_PACKAGE_kmod-ipt-nat=y              # 网络地址转换支持
CONFIG_PACKAGE_kmod-nf-conntrack=y         # Netfilter 连接跟踪
CONFIG_PACKAGE_kmod-nf-nat=y               # Netfilter NAT 支持

# =============================================
# LuCI Web 管理界面
# =============================================

#
# LuCI 核心组件
#
CONFIG_PACKAGE_luci=y                      # LuCI Web 界面核心
CONFIG_PACKAGE_luci-base=y                 # LuCI 基础库和框架
CONFIG_PACKAGE_luci-compat=y               # LuCI 兼容层（新旧版本兼容）
CONFIG_PACKAGE_luci-mod-admin-full=y       # 完整管理模块
CONFIG_PACKAGE_luci-theme-bootstrap=y      # Bootstrap 主题（默认主题）
CONFIG_PACKAGE_luci-proto-ipv6=y           # IPv6 协议支持
CONFIG_PACKAGE_luci-proto-ppp=y            # PPP 协议支持

# =============================================
# LuCI 应用程序（插件）
# =============================================

#
# 系统管理类插件
#
CONFIG_PACKAGE_luci-app-automount=y        # 【自动挂载】自动挂载USB存储设备
CONFIG_PACKAGE_luci-app-firewall=y         # 【防火墙】图形化防火墙配置
CONFIG_PACKAGE_luci-app-diskman=y          # 【磁盘管理】磁盘分区和格式化工具

#
# 网络服务类插件
#
CONFIG_PACKAGE_luci-app-upnp=y             # 【UPnP】自动端口转发，游戏和P2P需要
CONFIG_PACKAGE_luci-app-samba=y            # 【网络共享】Samba文件共享服务
CONFIG_PACKAGE_luci-app-vsftpd=y           # 【FTP服务器】FTP文件传输服务
CONFIG_PACKAGE_luci-app-turboacc=y         # 【网络加速】流量加速和Offloading
CONFIG_PACKAGE_luci-app-sqm=y              # 【流量整形】QoS流量控制和带宽管理

#
# 实用工具类插件
#
CONFIG_PACKAGE_luci-app-hd-idle=y          # 【硬盘休眠】闲置时自动停转硬盘
CONFIG_PACKAGE_luci-app-parentcontrol=y    # 【家长控制】上网时间管理和网站过滤

#
# 可选插件（按需使用）
#
CONFIG_PACKAGE_luci-app-vlmcsd=y           # 【KMS激活】Windows/Office激活服务器
CONFIG_PACKAGE_luci-app-smartdns=y         # 【智能DNS】DNS解析优化和过滤

# =============================================
# 网络服务后台程序
# =============================================

#
# Web 和文件服务
#
CONFIG_PACKAGE_uhttpd=y                    # uHTTPd Web服务器（LuCI运行环境）
CONFIG_PACKAGE_uhttpd-mod-ubus=y           # uHTTPd ubus模块
CONFIG_PACKAGE_miniupnpd=y                 # UPnP服务守护进程
CONFIG_PACKAGE_samba36-server=y            # Samba文件共享服务器
CONFIG_PACKAGE_vsftpd-alt=y                # vsftpd FTP服务器（替代版本）
CONFIG_PACKAGE_hd-idle=y                   # 硬盘休眠守护进程

#
# 网络优化工具
#
CONFIG_PACKAGE_sqm-scripts=y               # 流量整形脚本

# =============================================
# 中文语言包
# =============================================

#
# LuCI 界面中文化
#
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y              # LuCI 基础界面中文
CONFIG_PACKAGE_luci-i18n-firewall-zh-cn=y          # 防火墙界面中文
CONFIG_PACKAGE_luci-i18n-upnp-zh-cn=y              # UPnP 界面中文
CONFIG_PACKAGE_luci-i18n-samba-zh-cn=y             # 网络共享界面中文
CONFIG_PACKAGE_luci-i18n-automount-zh-cn=y         # 自动挂载界面中文
CONFIG_PACKAGE_luci-i18n-hd-idle-zh-cn=y           # 硬盘休眠界面中文
CONFIG_PACKAGE_luci-i18n-parentcontrol-zh-cn=y     # 家长控制界面中文
CONFIG_PACKAGE_luci-i18n-vlmcsd-zh-cn=y            # KMS激活界面中文
CONFIG_PACKAGE_luci-i18n-smartdns-zh-cn=y          # 智能DNS界面中文

# =============================================
# 彻底禁用 DDNS 相关组件（解决警告问题）
# =============================================

# CONFIG_PACKAGE_ddns-scripts is not set              # 禁用动态DNS脚本
# CONFIG_PACKAGE_ddns-scripts-cloudflare is not set   # 禁用Cloudflare DDNS
# CONFIG_PACKAGE_ddns-scripts-freedns is not set      # 禁用FreeDNS DDNS
# CONFIG_PACKAGE_ddns-scripts-godaddy is not set      # 禁用GoDaddy DDNS
# CONFIG_PACKAGE_ddns-scripts-noip is not set         # 禁用No-IP DDNS
# CONFIG_PACKAGE_ddns-scripts-services is not set     # 禁用DDNS服务
# CONFIG_PACKAGE_luci-app-ddns is not set             # 禁用DDNS Web界面
# CONFIG_PACKAGE_luci-i18n-ddns-zh-cn is not set      # 禁用DDNS中文语言包

# =============================================
# 删除不需要的插件（节省空间）
# =============================================

# CONFIG_PACKAGE_luci-app-accesscontrol is not set    # 删除上网时间控制（与家长控制重复）
# CONFIG_PACKAGE_luci-app-nlbwmon is not set          # 删除带宽监控（资源占用大）
# CONFIG_PACKAGE_luci-app-wol is not set              # 删除网络唤醒（WNDR3800不常用）
# CONFIG_PACKAGE_luci-app-autoreboot is not set       # 删除定时重启（可通过cron实现）

# =============================================
# 可选网络功能（性能增强）
# =============================================

#
# 网络性能优化
#
CONFIG_PACKAGE_iptables-mod-fullconenat=y  # 【全锥形NAT】改善P2P和游戏连接
CONFIG_PACKAGE_tcp-bbr=y                   # 【BBR拥塞控制】Google TCP加速算法

#
# 可选服务程序
#
CONFIG_PACKAGE_vlmcsd=y                    # KMS激活服务器后台
CONFIG_PACKAGE_smartdns=y                  # 智能DNS服务器后台

# =============================================
# 编译设置
# =============================================

#
# 通用编译选项
#
CONFIG_SIGNED_PACKAGES=y                   # 签名软件包（安全验证）
CONFIG_STRIP_KERNEL_EXPORTS=y              # 剥离内核导出符号（减小体积）

#
# 开发调试选项（通常禁用）
#
# CONFIG_DEBUG=y is not set                 # 禁用调试符号（减小体积）
# CONFIG_STRIP=y is not set                 # 禁用二进制剥离（开发时启用）

# =============================================
# 可选功能注释（根据需求取消注释）
# =============================================

#
# 更多文件系统支持（按需启用）
#
# CONFIG_PACKAGE_kmod-fs-btrfs=y           # Btrfs 文件系统支持（高级功能）
# CONFIG_PACKAGE_kmod-fs-f2fs=y            # F2FS 文件系统支持（闪存优化）

#
# 更多USB支持（按需启用）
#
# CONFIG_PACKAGE_kmod-usb3=y               # USB 3.0 支持（WNDR3800无USB3.0）
# CONFIG_PACKAGE_kmod-usb-xhci-hcd=y       # xHCI USB 控制器支持

#
# 更多网络协议支持（按需启用）
#
# CONFIG_PACKAGE_luci-app-wireguard=y      # WireGuard VPN 支持
# CONFIG_PACKAGE_luci-app-openvpn=y        # OpenVPN 客户端/服务器

#
# 监控统计工具（按需启用）
#
# CONFIG_PACKAGE_luci-app-statistics=y     # 系统统计监控（资源占用较大）
# CONFIG_PACKAGE_collectd=y                # 系统数据收集守护进程

# =============================================
# 配置总结
# =============================================
#
# 本配置特点：
# 1. 针对 WNDR3800 128MB 闪存优化
# 2. 彻底解决 DDNS 警告问题
# 3. 增强 USB 存储支持，自动挂载
# 4. 包含完整的网络加速和流量控制
# 5. 中文化界面，易于使用
# 6. 精选实用插件，避免功能冗余
#
# 主要功能：
# ✓ 无线网络 (802.11n)
# ✓ 千兆有线网络
# ✓ USB 存储共享 (Samba/FTP)
# ✓ 流量整形 QoS
# ✓ 家长控制
# ✓ 网络加速
# ✓ 自动挂载 U盘
# ✓ 硬盘休眠
# ✓ UPnP 自动端口转发
#
# 编译提示：此配置适合家庭和小型办公使用
#
