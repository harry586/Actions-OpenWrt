# =============================================================================
# OpenWrt 编译配置文件 - Netgear WNDR3800 专用
# 紧凑注释版本 - 所有注释在同一行内
# =============================================================================

# 目标系统配置
CONFIG_TARGET_ath79=y                      # Atheros AR71xx/AR913x/AR934x 架构
CONFIG_TARGET_ath79_generic=y              # 通用 ath79 目标平台
CONFIG_TARGET_ath79_generic_DEVICE_netgear_wndr3800=y  # 具体设备型号

# 镜像文件系统配置
CONFIG_TARGET_ROOTFS_SQUASHFS=y            # SquashFS 只读文件系统（压缩率高，安全）
CONFIG_TARGET_ROOTFS_PARTSIZE=128          # 根分区大小 128MB（WNDR3800 闪存容量）

# 内核版本配置
CONFIG_LINUX_5_15=y                        # Linux 5.15 内核（稳定版本）
CONFIG_KERNEL_BUILD_USER="OpenWrt"         # 内核构建用户标识
CONFIG_KERNEL_BUILD_DOMAIN="openwrt.org"   # 内核构建域名标识

# =============================================================================
# 基础系统包（核心组件，必需）
# =============================================================================
CONFIG_PACKAGE_base-files=y                # 基础文件系统结构和脚本
CONFIG_PACKAGE_busybox=y                   # 嵌入式 Linux 工具集合（核心命令）
CONFIG_PACKAGE_ca-bundle=y                 # CA 根证书包（HTTPS访问必需）
CONFIG_PACKAGE_dropbear=y                  # 轻量级 SSH 服务器（远程管理）
CONFIG_PACKAGE_firewall=y                  # iptables 防火墙前端（网络安全）
CONFIG_PACKAGE_fstools=y                   # 文件系统工具（挂载/格式化）
CONFIG_PACKAGE_libc=y                      # C 运行时库（程序运行基础）
CONFIG_PACKAGE_libgcc=y                    # GCC 运行时库（C++程序依赖）
CONFIG_PACKAGE_logd=y                      # 系统日志守护进程（日志管理）
CONFIG_PACKAGE_mtd=y                       # 内存技术设备工具（Flash操作）
CONFIG_PACKAGE_netifd=y                    # 网络接口管理守护进程（网络核心）
CONFIG_PACKAGE_opkg=y                      # 轻量级包管理器（软件安装）
CONFIG_PACKAGE_procd=y                     # OpenWrt 进程管理守护进程
CONFIG_PACKAGE_ubox=y                      # OpenWrt 基础工具箱
CONFIG_PACKAGE_ubus=y                      # OpenWrt 系统总线（进程通信）
CONFIG_PACKAGE_ubusd=y                     # ubus 守护进程
CONFIG_PACKAGE_uci=y                       # 统一配置接口（配置管理核心）
CONFIG_PACKAGE_usign=y                     # OpenWrt 签名工具（安全验证）

# =============================================================================
# 系统工具包（增强功能）
# =============================================================================
CONFIG_PACKAGE_bash=y                      # Bash shell（比默认ash更强大）
CONFIG_PACKAGE_htop=y                      # 交互式进程查看器（系统监控）
CONFIG_PACKAGE_nano=y                      # 简单易用文本编辑器（配置文件编辑）
CONFIG_PACKAGE_curl=y                      # 命令行URL传输工具（下载文件）
CONFIG_PACKAGE_cronie=y                    # 定时任务守护进程（计划任务）
CONFIG_PACKAGE_cronie-anacron=y            # anacron支持（错过任务补执行）

# =============================================================================
# 网络基础服务
# =============================================================================
CONFIG_PACKAGE_dnsmasq-full=y              # 完整版dnsmasq（DHCP+DNS缓存）
CONFIG_PACKAGE_dnsmasq_full_dhcp=y         # dnsmasq DHCP功能支持
CONFIG_PACKAGE_iptables=y                  # iptables防火墙核心
CONFIG_PACKAGE_iptables-mod-conntrack-extra=y  # 连接跟踪扩展模块
CONFIG_PACKAGE_ip-full=y                   # 完整版iproute2工具（网络配置）

# =============================================================================
# IPv6 支持
# =============================================================================
CONFIG_PACKAGE_ipv6helper=y                # IPv6配置助手（简化配置）
CONFIG_PACKAGE_odhcp6c=y                   # DHCPv6客户端（获取IPv6地址）
CONFIG_PACKAGE_odhcpd-ipv6only=y           # DHCPv6服务器（分配IPv6地址）

# =============================================================================
# 存储和文件系统支持（USB存储关键）
# =============================================================================
CONFIG_PACKAGE_automount=y                 # 自动挂载服务（U盘自动识别）
CONFIG_PACKAGE_block-mount=y               # 块设备挂载工具
CONFIG_PACKAGE_blkid=y                     # 块设备信息查看工具
CONFIG_PACKAGE_lsblk=y                     # 列出块设备信息
CONFIG_PACKAGE_e2fsprogs=y                 # EXT2/3/4文件系统工具
CONFIG_PACKAGE_fdisk=y                     # 磁盘分区工具
CONFIG_PACKAGE_usbutils=y                  # USB设备信息工具

# 内核模块 - 文件系统支持
CONFIG_PACKAGE_kmod-fs-ext4=y              # EXT4文件系统支持（Linux标准）
CONFIG_PACKAGE_kmod-fs-vfat=y              # FAT/FAT32文件系统支持（U盘常用）
CONFIG_PACKAGE_kmod-fs-ntfs3=y             # NTFS文件系统支持（Windows硬盘）
CONFIG_PACKAGE_kmod-fs-exfat=y             # exFAT文件系统支持（大文件U盘）
CONFIG_PACKAGE_kmod-fs-f2fs=y              # F2FS文件系统支持（闪存优化）
CONFIG_PACKAGE_kmod-nls-utf8=y             # UTF-8编码支持（中文文件名）
CONFIG_PACKAGE_kmod-nls-cp437=y            # CP437编码支持（FAT文件系统）
CONFIG_PACKAGE_kmod-nls-iso8859-1=y        # ISO-8859-1编码支持（西欧语言）
CONFIG_PACKAGE_kmod-nls-iso8859-15=y       # 额外编码支持

# 内核模块 - USB 支持（关键：解决U盘识别问题）
CONFIG_PACKAGE_kmod-usb-core=y             # USB核心支持（必需）
CONFIG_PACKAGE_kmod-usb2=y                 # USB 2.0支持（WNDR3800使用）
CONFIG_PACKAGE_kmod-usb-storage=y          # USB存储设备支持（U盘识别）
CONFIG_PACKAGE_kmod-usb-storage-uas=y      # USB Attached SCSI支持（新式U盘）
CONFIG_PACKAGE_kmod-usb-storage-extras=y   # USB存储扩展支持
CONFIG_PACKAGE_kmod-usb-ohci=y             # USB OHCI控制器支持
CONFIG_PACKAGE_kmod-usb-uhci=y             # USB UHCI控制器支持
CONFIG_PACKAGE_kmod-usb-ledtrig-usbport=y  # USB端口LED触发支持
CONFIG_PACKAGE_kmod-scsi-core=y            # SCSI核心支持（某些USB设备需要）
CONFIG_PACKAGE_kmod-scsi-generic=y         # SCSI通用设备支持

# 内核模块 - USB 设备支持
CONFIG_PACKAGE_kmod-usb-acm=y              # USB ACM支持（调制解调器）
CONFIG_PACKAGE_kmod-usb-serial=y           # USB串口设备支持
CONFIG_PACKAGE_kmod-usb-serial-ftdi=y      # FTDI USB串口芯片支持
CONFIG_PACKAGE_kmod-usb-serial-pl2303=y    # PL2303 USB转串口支持

# 内核模块 - 无线网络
CONFIG_PACKAGE_kmod-ath=y                  # Atheros无线驱动通用模块
CONFIG_PACKAGE_kmod-ath9k=y                # Atheros 802.11n无线驱动（WNDR3800无线）
CONFIG_PACKAGE_kmod-ath9k-common=y         # Atheros通用支持模块
CONFIG_PACKAGE_kmod-cfg80211=y             # 无线配置API
CONFIG_PACKAGE_kmod-mac80211=y             # MAC 802.11无线栈
CONFIG_PACKAGE_wpad-openssl=y              # WPA认证守护进程（OpenSSL版本）

# 内核模块 - 网络功能
CONFIG_PACKAGE_kmod-ipt-conntrack=y        # 连接跟踪支持
CONFIG_PACKAGE_kmod-ipt-core=y             # iptables核心模块
CONFIG_PACKAGE_kmod-ipt-nat=y              # 网络地址转换支持
CONFIG_PACKAGE_kmod-nf-conntrack=y         # Netfilter连接跟踪
CONFIG_PACKAGE_kmod-nf-nat=y               # Netfilter NAT支持

# =============================================================================
# LuCI Web 管理界面
# =============================================================================
CONFIG_PACKAGE_luci=y                      # LuCI Web界面核心
CONFIG_PACKAGE_luci-base=y                 # LuCI基础库和框架
CONFIG_PACKAGE_luci-compat=y               # LuCI兼容层（新旧版本兼容）
CONFIG_PACKAGE_luci-mod-admin-full=y       # 完整管理模块
CONFIG_PACKAGE_luci-theme-bootstrap=y      # Bootstrap主题（默认主题）
CONFIG_PACKAGE_luci-proto-ipv6=y           # IPv6协议支持
CONFIG_PACKAGE_luci-proto-ppp=y            # PPP协议支持

# =============================================================================
# LuCI 应用程序（插件）
# =============================================================================
CONFIG_PACKAGE_luci-app-automount=y        # 【自动挂载】自动挂载USB存储设备
CONFIG_PACKAGE_luci-app-firewall=y         # 【防火墙】图形化防火墙配置
CONFIG_PACKAGE_luci-app-diskman=y          # 【磁盘管理】磁盘分区和格式化工具
CONFIG_PACKAGE_luci-app-upnp=y             # 【UPnP】自动端口转发（游戏/P2P需要）
CONFIG_PACKAGE_luci-app-samba=y            # 【网络共享】Samba文件共享服务
CONFIG_PACKAGE_luci-app-vsftpd=y           # 【FTP服务器】FTP文件传输服务
CONFIG_PACKAGE_luci-app-turboacc=y         # 【网络加速】流量加速和Offloading
CONFIG_PACKAGE_luci-app-sqm=y              # 【流量整形】QoS流量控制和带宽管理
CONFIG_PACKAGE_luci-app-hd-idle=y          # 【硬盘休眠】闲置时自动停转硬盘
CONFIG_PACKAGE_luci-app-parentcontrol=y    # 【家长控制】上网时间管理和网站过滤
CONFIG_PACKAGE_luci-app-vlmcsd=y           # 【KMS激活】Windows/Office激活服务器
CONFIG_PACKAGE_luci-app-smartdns=y         # 【智能DNS】DNS解析优化和过滤

# =============================================================================
# 网络服务后台程序
# =============================================================================
CONFIG_PACKAGE_uhttpd=y                    # uHTTPd Web服务器（LuCI运行环境）
CONFIG_PACKAGE_uhttpd-mod-ubus=y           # uHTTPd ubus模块
CONFIG_PACKAGE_miniupnpd=y                 # UPnP服务守护进程
CONFIG_PACKAGE_samba36-server=y            # Samba文件共享服务器
CONFIG_PACKAGE_vsftpd-alt=y                # vsftpd FTP服务器（替代版本）
CONFIG_PACKAGE_hd-idle=y                   # 硬盘休眠守护进程
CONFIG_PACKAGE_sqm-scripts=y               # 流量整形脚本
CONFIG_PACKAGE_vlmcsd=y                    # KMS激活服务器后台
CONFIG_PACKAGE_smartdns=y                  # 智能DNS服务器后台

# =============================================================================
# 中文语言包
# =============================================================================
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y              # LuCI基础界面中文
CONFIG_PACKAGE_luci-i18n-firewall-zh-cn=y          # 防火墙界面中文
CONFIG_PACKAGE_luci-i18n-upnp-zh-cn=y              # UPnP界面中文
CONFIG_PACKAGE_luci-i18n-samba-zh-cn=y             # 网络共享界面中文
CONFIG_PACKAGE_luci-i18n-automount-zh-cn=y         # 自动挂载界面中文
CONFIG_PACKAGE_luci-i18n-hd-idle-zh-cn=y           # 硬盘休眠界面中文
CONFIG_PACKAGE_luci-i18n-parentcontrol-zh-cn=y     # 家长控制界面中文
CONFIG_PACKAGE_luci-i18n-vlmcsd-zh-cn=y            # KMS激活界面中文
CONFIG_PACKAGE_luci-i18n-smartdns-zh-cn=y          # 智能DNS界面中文

# =============================================================================
# 彻底禁用 DDNS 相关组件（解决警告问题）
# =============================================================================
# CONFIG_PACKAGE_ddns-scripts is not set              # 禁用动态DNS脚本
# CONFIG_PACKAGE_ddns-scripts-cloudflare is not set   # 禁用Cloudflare DDNS
# CONFIG_PACKAGE_ddns-scripts-freedns is not set      # 禁用FreeDNS DDNS
# CONFIG_PACKAGE_ddns-scripts-godaddy is not set      # 禁用GoDaddy DDNS
# CONFIG_PACKAGE_ddns-scripts-noip is not set         # 禁用No-IP DDNS
# CONFIG_PACKAGE_ddns-scripts-services is not set     # 禁用DDNS服务
# CONFIG_PACKAGE_luci-app-ddns is not set             # 禁用DDNS Web界面
# CONFIG_PACKAGE_luci-i18n-ddns-zh-cn is not set      # 禁用DDNS中文语言包

# =============================================================================
# 删除不需要的插件（节省空间）
# =============================================================================
# CONFIG_PACKAGE_luci-app-accesscontrol is not set    # 删除上网时间控制（重复功能）
# CONFIG_PACKAGE_luci-app-nlbwmon is not set          # 删除带宽监控（资源占用大）
# CONFIG_PACKAGE_luci-app-wol is not set              # 删除网络唤醒（不常用）
# CONFIG_PACKAGE_luci-app-autoreboot is not set       # 删除定时重启（cron可实现）

# =============================================================================
# 可选网络功能（性能增强）
# =============================================================================
CONFIG_PACKAGE_iptables-mod-fullconenat=y  # 【全锥形NAT】改善P2P和游戏连接
CONFIG_PACKAGE_tcp-bbr=y                   # 【BBR拥塞控制】Google TCP加速算法

# =============================================================================
# 编译设置
# =============================================================================
CONFIG_SIGNED_PACKAGES=y                   # 签名软件包（安全验证）
CONFIG_STRIP_KERNEL_EXPORTS=y              # 剥离内核导出符号（减小体积）
# CONFIG_DEBUG=y is not set                 # 禁用调试符号（减小体积）
# CONFIG_STRIP=y is not set                 # 禁用二进制剥离（开发时启用）

# =============================================================================
# 可选功能注释（根据需求取消注释）
# =============================================================================
# CONFIG_PACKAGE_kmod-fs-btrfs=y           # Btrfs文件系统支持（高级功能）
# CONFIG_PACKAGE_luci-app-wireguard=y      # WireGuard VPN支持
# CONFIG_PACKAGE_luci-app-openvpn=y        # OpenVPN客户端/服务器
# CONFIG_PACKAGE_luci-app-statistics=y     # 系统统计监控（资源占用较大）

# =============================================================================
# 配置总结
# =============================================================================
# 本配置特点：
# 1. 针对WNDR3800 128MB闪存优化
# 2. 彻底解决DDNS警告问题
# 3. 增强USB存储支持，自动挂载
# 4. 包含完整的网络加速和流量控制
# 5. 中文化界面，易于使用
# 6. 精选实用插件，避免功能冗余
#
# 主要功能：
# ✓ 无线网络(802.11n) ✓ 千兆有线网络 ✓ USB存储共享
# ✓ 流量整形QoS ✓ 家长控制 ✓ 网络加速 ✓ 自动挂载U盘
# ✓ 硬盘休眠 ✓ UPnP自动端口转发
#
# 编译提示：此配置适合家庭和小型办公使用
